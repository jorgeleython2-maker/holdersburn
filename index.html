<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>BURN $sdgsdg</title>
  <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.91.1/dist/index.iife.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@solana/spl-token@0.4.8/lib/index.iife.min.js"></script>
  <style>
    body{font-family:Arial;background:#000;color:#FF6B00;text-align:center;padding:50px;}
    input,button{padding:15px;font-size:20px;margin:10px;border-radius:10px;}
    button{background:#FF0000;color:white;border:none;cursor:pointer;}
    input{width:300px;text-align:center;}
  </style>
</head>
<body>
  <h1>QUEMAR $sdgsdg</h1>
  <button id="connect">CONNECT WALLET</button>
  <p id="balance"></p>
  <input type="number" id="amount" placeholder="Cantidad (ej: 10000)" />
  <button id="burn">QUEMAR TOKENS</button>

  <script>
    const MINT = "E1kjpery9wkprYe9phhwSHKtCmQwMNaoy6soa3Wfpump"; // TU TOKEN
    let wallet = null;

    document.getElementById("connect").onclick = async () => {
      if (!window.solana) return alert("Instala Phantom");
      await window.solana.connect();
      wallet = window.solana.publicKey.toString();
      document.getElementById("connect").innerText = wallet.slice(0,6)+"..."+wallet.slice(-4);
      getBalance();
    };

    async function getBalance() {
      if (!wallet) return;
      const resp = await fetch("https://api.mainnet-beta.solana.com", {
        method:"POST",
        body: JSON.stringify({
          jsonrpc:"2.0", id:"1",
          method:"getTokenAccountsByOwner",
          params:[wallet, {mint:MINT}, {encoding:"jsonParsed"}]
        })
      });
      const data = await resp.json();
      let bal = 0;
      if (data.result?.value?.length > 0) {
        bal = data.result.value[0].account.data.parsed.info.tokenAmount.uiAmount;
      }
      document.getElementById("balance").innerHTML = `<h2>Tienes ${bal} $sdgsdg</h2>`;
    }

    document.getElementById("burn").onclick = async () => {
      if (!wallet) return alert("Conecta primero");
      const amount = parseFloat(document.getElementById("amount").value);
      if (!amount || amount <= 0) return alert("Cantidad inválida");

      try {
        const connection = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com");
        const mint = new solanaWeb3.PublicKey(MINT);
        const owner = new solanaWeb3.PublicKey(wallet);

        // Obtener ATA
        const accounts = await connection.getTokenAccountsByOwner(owner, {mint});
        if (accounts.value.length === 0) return alert("No tienes tokens");
        const ata = accounts.value[0].pubkey;

        // Quema
        const tx = new solanaWeb3.Transaction().add(
          splToken.Token.createBurnInstruction(
            splToken.TOKEN_PROGRAM_ID,
            mint,
            ata,
            owner,
            [],
            BigInt(Math.floor(amount * 1000000000)) // 9 decimales
          )
        );

        tx.feePayer = owner;
        tx.recentBlockhash = (await connection.getLatestBlockhash()).blockhash;

        const signed = await window.solana.signTransaction(tx);
        const sig = await connection.sendRawTransaction(signed.serialize());
        await connection.confirmTransaction(sig);

        alert(`¡QUEMADOS ${amount} $sdgsdg!\nhttps://solscan.io/tx/${sig}`);
        getBalance();
        document.getElementById("amount").value = "";

      } catch (e) {
        alert("Error: " + e.message);
      }
    };
  </script>
</body>
</html>